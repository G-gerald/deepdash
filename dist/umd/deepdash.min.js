!function(e,n){"object"==typeof exports&&"undefined"!=typeof module?module.exports=n():"function"==typeof define&&define.amd?define(n):(e=e||self).deepdash=n()}(this,function(){"use strict";function e(e){return function(n,r,t){if(!e[n])if(e.mixin){var i={};i[n]=r,void 0===t&&(t=!0),e.mixin(i,{chain:t})}else e[n]=r;return e}}var n=/^\d+$/,r=/^[a-zA-Z_$]+([\w_$]*)$/;function t(e){return function(t){return e.isString(t)?t:e.isArray(t)?e.reduce(t,function(e,t){return n.test(t)?e+"["+t+"]":r.test(t)?e+(e?".":"")+t:e+'["'+t.toString().replace(/"/g,'\\"')+'"]'},""):void 0}}function i(e){var n=function(e){var n=t(e),r=function(e){return function(n,r){return e.some(r,r=>{var t=e.get(n,r);return!e.isEmpty(t)})}}(e),i=e.each||e.forArray;return function t(a,o,c,l,u,h,d,p,s,f){var v,y={value:a,key:l,path:"array"==c.pathFormat?u:n(u),parent:d},m=p.concat(y),k=void 0,C=void 0,P=void 0;c.checkCircular&&(e.isObject(a)&&!e.isEmpty(a)?P=p[C=e.findIndex(p,function(e){return e.value===a})]||null:(C=-1,P=null),k=-1!==C);var g=(h||c.includeRoot)&&(!c.leavesOnly||!e.isObject(a)||e.isEmpty(a)||k||void 0!==c.childrenPath&&!r(a,c.childrenPath));if(g){var O={path:"array"==c.pathFormat?u:n(u),parent:d,parents:p,obj:s,depth:h,isCircular:k,circularParent:P,circularParentIndex:C};void 0!==c.childrenPath&&(y.childrenPath="array"==c.pathFormat?f:n(f),O.childrenPath=y.childrenPath),v=o(a,l,d&&d.value,O)}function D(n,r){n&&e.isObject(n)&&e.forOwn(n,function(e,n){var i=(u||[]).concat(r||[],[n]);t(e,o,c,n,i,h+1,y,m,s,r)})}!1!==v&&!k&&e.isObject(a)&&(void 0!==c.childrenPath?!h&&c.rootIsChildren?D(a,void 0):i(c.childrenPath,function(n){D(e.get(a,n),n)}):e.forOwn(a,function(n,r){if(!e.isArray(a)||void 0!==n||r in a){var i=(u||[]).concat([r]);t(n,o,c,r,i,h+1,y,m,s)}})),c.callbackAfterIterate&&g&&(O.afterIterate=!0,o(a,l,d&&d.value,O))}}(e);return function(r,t,i){if(void 0===t&&(t=e.identity),void 0!==(i=e.merge({includeRoot:!e.isArray(r),pathFormat:"string",checkCircular:!1,leavesOnly:!1},i||{})).childrenPath){if(i.includeRoot||void 0!==i.rootIsChildren||(i.rootIsChildren=e.isArray(r)),!e.isString(i.childrenPath)&&!e.isArray(i.childrenPath))throw Error("childrenPath can be string or array");e.isString(i.childrenPath)&&(i.childrenPath=[i.childrenPath]);for(var a=i.childrenPath.length-1;a>=0;a--)i.childrenPath[a]=e.toPath(i.childrenPath[a])}return n(r,t,i,void 0,void 0,0,void 0,[],r),r}}function a(n){return e(n)("index",function(e){var n=i(e);return function(r,t){t&&void 0!==t.leafsOnly&&(t.leavesOnly=t.leafsOnly);var i={pathFormat:"string",checkCircular:(t=e.merge({checkCircular:!1,includeCircularPath:!0,leavesOnly:!t||void 0===t.childrenPath},t||{})).checkCircular,childrenPath:t.childrenPath,includeRoot:t.includeRoot,leavesOnly:t.leavesOnly},a={};return n(r,function(e,n,r,i){i.isCircular&&!t.includeCircularPath||void 0!==i.path&&(a[i.path]=e)},i),a}}(n))}function o(e){var n=i(e);return function(r,t){t&&void 0!==t.leafsOnly&&(t.leavesOnly=t.leafsOnly);var i={pathFormat:(t=e.merge({checkCircular:!1,includeCircularPath:!0,leavesOnly:!t||void 0===t.childrenPath,pathFormat:"string"},t||{})).pathFormat,checkCircular:t.checkCircular,childrenPath:t.childrenPath,includeRoot:t.includeRoot,leavesOnly:t.leavesOnly},a=[];return n(r,function(e,n,r,i){i.isCircular&&!t.includeCircularPath||void 0!==i.path&&a.push(i.path)},i),a}}function c(e){return function(n,r){var t=(r=e.isArray(r)?e.clone(r):e.toPath(r)).pop(),i=r.length?e.get(n,r):n;return void 0!==i&&t in i}}function l(e){return function(e){for(var n=[],r=0;r<e.length;r++)r in e||n.push(r);for(var t=n.length;t--;)e.splice(n[t],1);return e}}function u(n){return e(n)("condense",l())}function h(e){var n=i(e),r=l(),t=e.each||e.forArray;return function(i,a){var o={checkCircular:(a=e.merge({checkCircular:!1},a||{})).checkCircular},c=[];return n(i,function(n,r,t,i){!i.isCircular&&e.isArray(n)&&c.push(n)},o),e.isArray(i)&&c.push(i),t(c,r),i}}function d(e){return function(n,r){return void 0===r?n:e.get(n,r)}}function p(e){var n=i(e),r=t(e),a=d(e),o=h(e),l=c(e);return function(t,i,c){i=e.iteratee(i),c&&void 0!==c.leafsOnly&&(c.leavesOnly=c.leafsOnly),c||(c={}),c.onTrue||(c.onTrue={}),c.onFalse||(c.onFalse={}),c.onUndefined||(c.onUndefined={}),void 0!==c.childrenPath&&(void 0===c.onTrue.skipChildren&&(c.onTrue.skipChildren=!1),void 0===c.onUndefined.skipChildren&&(c.onUndefined.skipChildren=!1),void 0===c.onFalse.skipChildren&&(c.onFalse.skipChildren=!1),void 0===c.onTrue.cloneDeep&&(c.onTrue.cloneDeep=!0),void 0===c.onUndefined.cloneDeep&&(c.onUndefined.cloneDeep=!0),void 0===c.onFalse.cloneDeep&&(c.onFalse.cloneDeep=!0));var u,h={pathFormat:(c=e.merge({checkCircular:!1,keepCircular:!0,leavesOnly:void 0===c.childrenPath,condense:!0,cloneDeep:e.cloneDeep,pathFormat:"string",onTrue:{skipChildren:!0,cloneDeep:!0,keepIfEmpty:!0},onUndefined:{skipChildren:!1,cloneDeep:!1,keepIfEmpty:!1},onFalse:{skipChildren:!0,cloneDeep:!1,keepIfEmpty:!1}},c)).pathFormat,checkCircular:c.checkCircular,childrenPath:c.childrenPath,includeRoot:c.includeRoot,callbackAfterIterate:!0,leavesOnly:c.leavesOnly},d=e.isArray(t)?[]:e.isObject(t)?{}:null,p={},s=[];return n(t,function(n,t,a,o){var l,h=r(o.path);if(!o.afterIterate)return o.isCircular?(e.unset(d,o.path),c.keepCircular&&s.push([o.path,o.circularParent.path]),!1):(l=i(n,t,a,o),e.isObject(l)||(l=void 0===l?e.clone(c.onUndefined):l?e.clone(c.onTrue):e.clone(c.onFalse)),void 0===l.empty&&(l.empty=!0),void 0!==h?(p[h]=l,e.eachRight(o.parents,function(e){var n=r(e.path);if(void 0===n||p[n])return!1;p[n]={skipChildren:!1,cloneDeep:!1,keepIfEmpty:!1,empty:l.empty}}),u||(u={skipChildren:!1,cloneDeep:!1,keepIfEmpty:!1,empty:l.empty})):u=l,!l.keepIfEmpty&&l.skipChildren||(c.cloneDeep&&l.cloneDeep?void 0!==o.path?e.set(d,o.path,c.cloneDeep(n)):d=c.cloneDeep(n):void 0!==o.path?e.set(d,o.path,e.isArray(n)?[]:e.isPlainObject(n)?{}:n):d=e.isArray(n)?[]:e.isPlainObject(n)?{}:n),!l.skipChildren);!o.afterIterate||o.isCircular||(void 0===h&&u.empty&&!u.keepIfEmpty?d=null:void 0!==h&&p[h].empty&&!p[h].keepIfEmpty?e.unset(d,o.path):(e.eachRight(o.parents,function(e){var n=r(e.path);if(void 0===n||!p[n].empty)return!1;p[n].empty=!1}),u.empty=!1))},h),u&&u.empty&&!u.keepIfEmpty?d=null:e.each(p,(n,r)=>{n.empty&&!n.keepIfEmpty&&e.unset(d,r)}),e.each(s,function(n){var r;(void 0===n[1]||l(d,n[1]))&&(r=e.has(c,"replaceCircularBy")?c.replaceCircularBy:a(d,n[1]),e.set(d,n[0],r))}),c.condense&&(d=o(d,{checkCircular:c.checkCircular})),!e.isArray(d)||d.length||h.includeRoot?d:null}}function s(e){var n=t(e);return function(r,t){var i,a;e.isString(r)?i=r:a=r,e.isArray(t)||(t=[t]);for(var o=0;o<t.length;o++)if(e.isString(t[o])&&(t[o]=e.toPath(t[o])),e.isArray(t[o])){if(void 0===a&&(a=e.toPath(i)),a.length>=t[o].length&&e.isEqual(e.takeRight(a,t[o].length),t[o]))return t[o]}else{if(!(t[o]instanceof RegExp))throw new Error("To match path use only string/regex or array of them.");if(void 0===i&&(i=n(r)),t[o].test(i))return t[o]}return!1}}function f(e){var n=s(e),r=p(e);return function(t,i,a){var o=!(a=e.merge({invert:!1},a||{})).invert;return(a=e.merge({onMatch:{cloneDeep:!1,skipChildren:!1,keepIfEmpty:!o},onNotMatch:{cloneDeep:!1,skipChildren:!1,keepIfEmpty:o}},a)).leavesOnly=!1,a.childrenPath=void 0,a.pathFormat="array",a.onTrue=a.invert?a.onMatch:a.onNotMatch,a.onFalse=a.invert?a.onNotMatch:a.onMatch,r(t,function(e,r,t,o){return!1!==n(o.path,i)?a.invert:!a.invert},a)}}function v(n){return e(n)("pickDeep",function(e){var n=f(e);return function(r,t,i){return(i=e.merge({invert:!1},i||{})).invert=!0,n(r,t,i)}}(n))}function y(n){return function(n){e(n)("pathToString",t(n),!1)}(n),function(n){e(n)("eachDeep",i(n))}(n),function(n){e(n)("forEachDeep",i(n))}(n),a(n),function(n){e(n)("paths",o(n))}(n),function(n){e(n)("keysDeep",o(n))}(n),function(n){e(n)("exists",c(n),!1)}(n),u(n),u(n),function(n){e(n)("condenseDeep",h(n))}(n),function(n){e(n)("filterDeep",p(n))}(n),function(n){e(n)("omitDeep",f(n))}(n),v(n),function(n){e(n)("obtain",d(n),!0)}(n),function(n){e(n)("pathMatches",s(n),!1)}(n),n}return"undefined"!=typeof _&&y(_),y});
